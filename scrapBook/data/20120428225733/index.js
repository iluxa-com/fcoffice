
window.V=window.V||{};V.util=V.util||{};if(window.QZFL&&QZFL.config&&QZFL.config.FSHelperPage){if(/\.pengyou\.com$/.test(location.hostname)){QZFL.config.FSHelperPage=QZFL.config.FSHelperPage.replace(/^http\:\/\/(?:[^\.]+\.)?qzs\.qq\.com/,'http://qzs.pengyou.com');}else if(/\.qq\.com$/.test(location.hostname)){QZFL.config.FSHelperPage=QZFL.config.FSHelperPage.replace(/^http\:\/\/qzs\.qq\.com/,'http://'+(function(){var _isp=QZFL.cookie.get('ptisp');if(({ctc:1,cnc:1,edu:1,cm:1,cn:1,os:1})[_isp]){return _isp+'.';}
return'';})()+'qzs.qq.com');}}
V.util.combine=function(){var objs=Array.prototype.slice.call(arguments,0);var res={};for(var i=0,obj;obj=objs[i];i++){for(var k in obj){res[k]=obj[k];}}
return res;};V.util.clickStat=function(tag,domain,path){if(!tag){return;}
domain=domain||window.location.hostname;path=path||window.location.pathname;var url=['http://pinghot.qq.com/pingd?dm=',domain,'.hot&url=',path,'&hottag=',tag,'&hotx=9999&hoty=9999&sds=',Math.random()].join('');QZFL.pingSender(url);};V.util.getUin=function(){var uin=QZFL.cookie.get('uin');if(!uin){return 0;}
uin=/^o(\d+)$/.exec(uin);if(uin&&(uin=new Number(uin[1])+0)>10000){return uin;}
return 0;};V.util.appendUrlParam=function(url,param,forHash){if(!url){return'';}
if(!param){return url;}
var p=[];for(var k in param){p.push(encodeURIComponent(k)+'='+encodeURIComponent(param[k]));}
p=p.join('&');var hash=url.split('#');url=hash[0].split('?');hash=hash[1]?('#'+hash[1]):'';param=url[1]?('?'+url[1]):'';url=url[0];var v=forHash?hash:param;v=v?v.lastIndexOf('&')==v.length-1?(v+p):(v+'&'+p):('?'+p);if(forHash){hash=v;}else{param=v;}
return url+param+hash;};V.util.getToken=function(){var str=QZFL.cookie.get('skey')||'';var hash=5381;for(var i=0,len=str.length;i<len;++i){hash+=(hash<<5)+str.charCodeAt(i);}
return hash&0x7fffffff;};V.util.loadJson=function(opt){opt=V.util.combine({timeout:5000,charset:'utf-8',cbFn:'_Callback',valueStatKey:'ret',getRetCodeValueStat:V.util._getRetCodeValueStat,successReportRate:1,errorReportRate:1},opt);if(!opt.url){return;}
opt.param=V.util.combine(QZFL.pluginsDefine&&QZFL.pluginsDefine.getACSRFToken?{uin:V.util.getUin()}:{uin:V.util.getUin(),g_tk:V.util.getToken()},opt.param);opt.random&&(opt.param._r=Math.random());var startTime;var j=new QZFL.JSONGetter(opt.url,'_vasJsonInstance_'+(QZFL.JSONGetter.counter+1),opt.param,opt.charset);if(opt.valueStatId){j.onSuccess=function(ret){var duration=new Date()-startTime;var valueStat=opt.getRetCodeValueStat(ret[opt.valueStatKey]);if(valueStat){TCISD.valueStat(opt.valueStatId,valueStat[0],valueStat[1]+'',{duration:duration,reportRate:opt.successReportRate});}
opt.onSuccess&&opt.onSuccess(ret);};j.onError=function(){var duration=new Date()-startTime;TCISD.valueStat(opt.valueStatId,2,'1',{duration:duration,reportRate:opt.errorReportRate});opt.onError&&opt.onError();};j.onTimeout=function(){opt.onTimeout?opt.onTimeout():opt.onError&&opt.onError();};}else{j.onSuccess=opt.onSuccess||QZFL.emptyFn;j.onError=opt.onError||QZFL.emptyFn;j.onTimeout=opt.onTimeout||opt.onError||QZFL.emptyFn;}
j.timeout=opt.timeout;if(opt.valueStatId){startTime=new Date();}
j.send(opt.cbFn);};V.util.postForm=function(opt){opt=V.util.combine({charset:'utf-8',valueStatKey:'ret',getRetCodeValueStat:V.util._getRetCodeValueStat,successReportRate:1,errorReportRate:1},opt);if(!opt.url){return;}
opt.query=V.util.combine(QZFL.pluginsDefine&&QZFL.pluginsDefine.getACSRFToken?{uin:V.util.getUin()}:{uin:V.util.getUin(),g_tk:V.util.getToken()},opt.query);opt.param=V.util.combine({uin:V.util.getUin(),g_tk:V.util.getToken()},opt.param);var url=V.util.appendUrlParam(opt.url,opt.query);var startTime;var f=new QZFL.FormSender(url,'POST',opt.param,opt.charset);if(opt.valueStatId){f.onSuccess=function(ret){var duration=new Date()-startTime;var valueStat=opt.getRetCodeValueStat(ret[opt.valueStatKey]);if(valueStat){TCISD.valueStat(opt.valueStatId,valueStat[0],valueStat[1]+'',{duration:duration,reportRate:opt.successReportRate});}
opt.onSuccess&&opt.onSuccess(ret);};f.onError=function(){var duration=new Date()-startTime;TCISD.valueStat(opt.valueStatId,2,'1',{duration:duration,reportRate:opt.errorReportRate});opt.onError&&opt.onError();};}else{f.onSuccess=opt.onSuccess||QZFL.emptyFn;f.onError=opt.onError||QZFL.emptyFn;}
if(opt.valueStatId){startTime=new Date();}
f.send();};V.util.xhr=function(opt){opt=V.util.combine({method:'POST',param:{},sync:0,noCache:0,charset:'utf-8',valueStatKey:'ret',getRetCodeValueStat:V.util._getRetCodeValueStat,successReportRate:1,errorReportRate:1},opt);if(!opt.url){return;}
opt.query=V.util.combine({uin:V.util.getUin(),g_tk:V.util.getToken()},opt.query);opt.param=V.util.combine({uin:V.util.getUin(),g_tk:V.util.getToken()},opt.param);var url=V.util.appendUrlParam(opt.url,opt.query);var startTime;var xhr=new QZFL.XHR(url,'_vasXhrInstance_'+(QZFL.XHR.counter+1),opt.method,opt.param,!opt.sync,opt.noCache);xhr.charset=opt.charset;var onError=opt.valueStatId?(function(){var duration=new Date()-startTime;TCISD.valueStat(opt.valueStatId,2,'1',{duration:duration,reportRate:opt.errorReportRate});opt.onError&&opt.onError();}):(opt.onError||function(){});var onSuccess=opt.onSuccess?(function(ret){if(ret.text){try{opt.onSuccess(JSON.parse(ret.text));}catch(_){onError();}}else{opt.onSuccess({});}}):(function(){});if(opt.valueStatId){xhr.onSuccess=function(ret){var duration=new Date()-startTime;var valueStat=opt.getRetCodeValueStat(ret[opt.valueStatKey]);if(valueStat){TCISD.valueStat(opt.valueStatId,valueStat[0],valueStat[1]+'',{duration:duration,reportRate:opt.successReportRate});}
onSuccess(ret);};}else{xhr.onSuccess=onSuccess;}
xhr.onError=onError;if(opt.valueStatId){startTime=new Date();}
xhr.send();};V.util._getRetCodeValueStat=function(ret){return ret==0?[1,0]:[2,ret];};V.util.tmpl=function(str,param){if(!str){return'';}
param=param||{};var obj=QZFL.dom.get(str);obj&&(str=obj.innerHTML);var fn=['var __=[];'];var re=/([\s\S]*?)(?:(?:<%([^=][\s\S]*?)%>)|(?:<%=([\s\S]+?)%>)|$)/g;re.lastIndex=0;var m=re.exec(str||'');while(m&&(m[1]||m[2]||m[3])){m[1]&&fn.push('__.push(\'',QZFL.string.escString(m[1]),'\');');m[2]&&fn.push(m[2]);m[3]&&fn.push('__.push(',m[3],');');m=re.exec(str);}
fn.push('return __.join(\'\');');var args=[],argv=[];for(var key in param){args.push(key);argv.push(param[key]);}
fn=new Function(args.join(','),fn.join(''));return fn.apply(null,argv);};V.util.performanceTimeStat=function(flag1,flag2,flag3,delay){setTimeout(function(){var performance=window.performance||window.webkitPerformance||window.msPerformance;if(!performance||!window.TCISD){return;}
var list=[performance.timing.navigationStart,performance.timing.unloadEventStart,performance.timing.unloadEventEnd,performance.timing.redirectStart,performance.timing.redirectEnd,performance.timing.fetchStart,performance.timing.domainLookupStart,performance.timing.domainLookupEnd,performance.timing.connectStart,performance.timing.connectEnd,performance.timing.requestStart,performance.timing.responseStart,performance.timing.responseEnd,performance.timing.domLoading,performance.timing.domInteractive,performance.timing.domContentLoadedEventStart,performance.timing.domContentLoadedEventEnd,performance.timing.domComplete,performance.timing.loadEventStart,performance.timing.loadEventEnd];V.util.timeStat(flag1,flag2,flag3,list);},delay||0);};V.util.timeStat=function(flag1,flag2,flag3,timeStamps,delay){setTimeout(function(){var o=new TCISD.TimeStat(null,[flag1,flag2,flag3].join('_'));o.zero=timeStamps[0];o.timeStamps=timeStamps;o.report();},delay||0);};V.util.getUrlParam=function(name){var re=new RegExp('(?:\\?|#|&)'+name+'=([^&]*)(?:$|&|#)','i');var m=re.exec(window.location.href);return m?m[1]:'';};V.util.formatDate=function formatDate(time,fmt,forEng){time=new Date(time);var ss=function(s,n,m,o){s=(s+'').split('');m&&(n=Math.min(n,m));o=o||0;var l=s.length;if(o&1){for(var i=l;i<n;i++){(o&4)?s.push(0):s.unshift(0);}}
if(n<l&&(o&2)){if(o&4){s=s.slice(0,n);}else{s=s.slice(l-n,l);}}
s=s.join('');(o&8)&&(s=s.replace(/^0*(.+?)0*$/,'$1'));return s;};return fmt.replace(/(y|M|d|h|H|m|s|f|F|t)+/g,function(match){var c=match.charAt(0),l=match.length;switch(c){case'y':return ss(time.getFullYear(),l,4,2);case'M':if(l<=2){return ss(time.getMonth()+1,l,2,1);}
return(forEng?(l==3?['Jan','Feb','Mar','Apr','May','Jun','Jul','Aug','Sep','Oct','Nov','Dec']:['January','February','March','April','May','June','July','August','September','October','November','December']):['一月','二月','三月','四月','五月','六月','七月','八月','九月','十月','十一月','十二月'])[time.getMonth()];case'd':if(l<=2){return ss(time.getDate(),l,2,1);}
return(forEng?(l==3?['Sun','Mon','Tue','Wed','Thu','Fri','Sat']:['Sunday','Monday','Tuesday','Wednesday','Thurday ','Friday','Saturday']):['星期日','星期一','星期二','星期三','星期四','星期五','星期六'])[time.getDay()];case'h':return ss((time.getHours()%12)||12,l,2,1);case'H':return ss(time.getHours(),l,2,1);case'm':return ss(time.getMinutes(),l,2,1);case's':return ss(time.getSeconds(),l,2,1);case'f':return ss(time.getMilliseconds(),l,0,7);case'F':return ss(time.getMilliseconds(),l,0,14);case't':return ss(time.getHours()>=12?(forEng?'PM':'下午'):(forEng?'AM':'上午'),l,2,6);default:return match;}});};V.util.toStr=function(obj){return Object.prototype.toString.call(obj);};V.util.getPortrait=function(uins,cb,cbErr){uins+='';V.util.loadJson({url:'http://r.qzone.qq.com/fcg-bin/cgi_get_score.fcg',param:{mask:4,uins:V.util.toStr(uins)=='[object Array]'?uins.join(','):uins},onSuccess:function(ret){var _uins=V.util.toStr(uins)=='[object Array]'?uins:uins.split(',');var _args={};for(var i=0,one;one=_uins[i];i++){_args[one]=(ret[one]&&ret[one][6])||one;}
cb(_args);},onError:cbErr,cbFn:'portraitCallBack',charset:'gbk'});};window.V=window.V||{};V.widget=V.widget||{};V.widget.mouseEvent=function(firer,opt){if(!firer){return;}
opt=V.util.combine({delayOnMouseOverOut:500},opt);function getSingleOrArray(o){return o?V.util.toStr(o)==='[object Array]'?o:[o]:[];}
function getTarget(evt,container,type){var src=QZFL.event.getTarget(evt),action,skip;while(true){action=src.getAttribute('_action');skip=(src.getAttribute('_skip')||'').split(',');for(var i=0,s;s=skip[i];i++){if(s==type){skip=true;break;}}
if(action&&skip!==true){return{src:src,action:action};}
if(src==container){return;}
src=src.parentNode;}}
opt.target&&(this.target=QZFL.dom.get(opt.target));this.firer=getSingleOrArray(firer);this._pendingCallback=false;this.fixed=opt.fixed?opt.status?1:-1:0;opt.alwaysAction=getSingleOrArray(opt.alwaysAction);this.alwaysAction={};for(var i=0,aa;aa=opt.alwaysAction[i];i++){this.alwaysAction[aa]=1;}
this.data={status:!!opt.status,action:opt.action};this.startupCallback=opt.startup;this.shutdownCallback=opt.shutdown;this.timer=new V.widget.mouseEvent._timer(V.widget.mouseEvent._eventHandler,this);QZFL.object.each(this.firer,QZFL.object.bind(this,function(el){QZFL.event.on(el,'click',QZFL.object.bind(this,function(evt){var target=getTarget(evt,el,'click');if(!target){return;}
this.startup(target.action,0,{evt:evt,firer:target.src});}));if(opt.useMouseOverOut){QZFL.event.on(el,'mouseover',QZFL.object.bind(this,function(evt){var target=getTarget(evt,el,'mouseover');if(!target){return;}
this.startup(target.action,opt.delayOnMouseOverOut,{evt:evt,firer:target.src});}));QZFL.event.on(el,'mouseout',QZFL.object.bind(this,function(evt){this.shutdown(opt.delayOnMouseOverOut,{evt:evt});}));}}));if(opt.useMouseOverOut&&this.target){QZFL.event.on(this.target,'mouseover',QZFL.object.bind(this,function(evt){this.timer.run({type:'self',opt:{evt:evt}},opt.delayOnMouseOverOut);}));QZFL.event.on(this.target,'mouseout',QZFL.object.bind(this,function(evt){this.timer.run({type:'shutdown',opt:{evt:evt}},opt.delayOnMouseOverOut);}));}};V.widget.mouseEvent.prototype.dispose=function(){QZFL.object.each(this.firer,QZFL.object.bind(this,function(el){QZFL.event.purgeEvent(el,'click');QZFL.event.purgeEvent(el,'mouseover');QZFL.event.purgeEvent(el,'mouseout');}));if(this.target){QZFL.event.purgeEvent(this.target,'mouseover');QZFL.event.purgeEvent(this.target,'mouseout');}};V.widget.mouseEvent.prototype.startup=function(action,delay,opt){if(!action){return;}
this.timer.run({type:'startup',action:action,opt:opt},delay);};V.widget.mouseEvent.prototype.shutdown=function(delay,opt){this.timer.run({type:'shutdown',opt:opt},delay);};V.widget.mouseEvent._eventHandler=function(list){if(this._pendingCallback){return;}
var current=V.util.combine(this.data),lastAction=current.action;var one=list.shift();var opt={};while(one){switch(one.type){case'startup':current.status=true;lastAction=current.action;current.action=one.action;opt=one.opt||opt;break;case'shutdown':current.status=false;current.action=lastAction;opt=one.opt||opt;break;case'self':current.status=true;opt=one.opt||opt;break;}
one=list.shift();}
if(this.fixed){current.status=this.fixed>0;}
if(current.status==this.data.status&&current.action==this.data.action&&!this.alwaysAction[current.action]){return;}
var fn=QZFL.object.bind(this,function(){this.data=V.util.combine(this.data,current);});var timeout=null;var onCompleteFn=QZFL.object.bind(this,function(){timeout=null;if(!this._pendingCallback){return;}
this._pendingCallback=false;this.timer.run();});var onComplete=function(){timeout=setTimeout(onCompleteFn,0);};var ret;if(current.status!=this.data.status){fn();this._pendingCallback=true;if(this.data.status){ret=this.startupCallback&&this.startupCallback(this.target,current.action,onComplete,opt);}else{ret=this.shutdownCallback&&this.shutdownCallback(this.target,onComplete,opt);}
if(ret!==false){this._pendingCallback=false;timeout&&clearTimeout(timeout);}}else if(current.action!=this.data.action||this.alwaysAction[current.action]){fn();var firstTimeout=null;var onFirstComplete=QZFL.object.bind(this,function(){firstTimeout=null;var ret=this.startupCallback&&this.startupCallback(this.target,current.action,onComplete,opt);if(ret!==false){this._pendingCallback=false;timeout&&clearTimeout(timeout);}});this._pendingCallback=true;ret=this.shutdownCallback&&this.shutdownCallback(this.target,function(){firstTimeout=setTimeout(onFirstComplete,0);},opt);if(ret!==false){firstTimeout&&clearTimeout(firstTimeout);onFirstComplete();}}};V.widget.mouseEvent._timer=function(handler,self){this.timer=null;this.handler=handler;this.self=self;this.list=[];this.time=0;this.running=false;};V.widget.mouseEvent._timer.prototype.run=function(arg,delay){if(this.running){setTimeout(QZFL.object.bind(this,function(){this.run(arg,delay);}),0);return;}
this.timer&&clearTimeout(this.timer);arg&&this.list.push(arg);var fn=QZFL.object.bind(this,function(){this.running=true;this.handler.call(this.self,this.list);this.running=false;this.list=[];this.time=0;});if(+delay){var now=new Date().getTime();delay=(this.time=Math.max(now+delay,this.time))-now;this.timer=setTimeout(fn,delay);}else{fn();}};window.V=window.V||{};V.widget=V.widget||{};V.widget.mouseEventPager=function(handler,pager,tmpls,total,opt){if(!handler){return;}
if(!(this.pager=pager)){return;}
this.tmpls=tmpls||{};if(!+total||total<1){total=1;}
this.opt=opt=V.util.combine({pre:2,post:4,delayOnMouseOver:500,circle:false},opt);var current=opt.current;if(!+current||current<1){current=1;}else if(current>total){current=total;}
var meOpt={startup:QZFL.object.bind(this,V.widget.mouseEventPager._startup),status:1,fixed:1,action:opt.runNow?'0':(current+'')};if(opt.useMouseOver){meOpt.useMouseOverOut=1;meOpt.delayOnMouseOverOut=opt.delayOnMouseOver;}
this.me=new V.widget.mouseEvent(pager,meOpt);this.total=total;this.current=current;this.tmpls=V.util.combine({container:'<%=firstPage%> <%=previousPage%> <%=pagerNumbers%> <%=nextPage%> <%=lastPage%>',number:'<a href="javascript:void(0)" onclick="return false;" _action="<%=page%>"><%=page%></a>',current:'<span><%=page%></span>',omission:'<span>...</span>',first:'<a href="javascript:void(0)" onclick="return false;" _action="<%=page%>">首页</a>',firstDisabled:'<span>首页</span>',previous:'<a href="javascript:void(0)" onclick="return false;" _action="<%=page%>">上页</a>',previousDisabled:'<span>上页</span>',next:'<a href="javascript:void(0)" onclick="return false;" _action="<%=page%>">下页</a>',nextDisabled:'<span>下页</span>',last:'<a href="javascript:void(0)" onclick="return false;" _action="<%=page%>">尾页</a>',lastDisabled:'<span>尾页</span>'},tmpls);if(opt.renderNow){this._render();}
this._pendingCallback=false;if(opt.delayOnAutoRotation){var fn=QZFL.object.bind(this,function(){this.timeout=setTimeout(QZFL.object.bind(this,function(){this.me.startup((this.current%this.total+1)+'');}),opt.delayOnAutoRotation);});this._handler=QZFL.object.bind(this,function(current,total,onComplete,onCanRender,opt){clearTimeout(this.timeout);var timeout=null;var myComplete=QZFL.object.bind(this,function(failed){fn();onComplete(failed);});if(handler(current,total,function(failed){timeout=setTimeout(function(){myComplete(failed);},0);},onCanRender,opt)===false){return false;}
timeout&&clearTimeout(timeout);fn();});fn();}else{this._handler=handler;}
if(opt.runNow){this.switchPage(1);}};V.widget.mouseEventPager.prototype.dispose=function(){this.me.dispose();};V.widget.mouseEventPager.prototype.switchPage=function(action){this.me.startup(action+'');};V.widget.mouseEventPager._startup=function(target,action,onComplete,opt){var current=+action;if(!current){return;}
var timeout=null;var rendered=false;var switchComplete=QZFL.object.bind(this,function(failed){timeout=null;if(!this._pendingCallback){return;}
this._pendingCallback=false;if(!failed){if(!rendered){rendered=true;this.current=current;this._render();}}
onComplete();});this._pendingCallback=true;var ret=this._handler(current,this.total,function(failed){timeout=setTimeout(function(){switchComplete(failed);},0);},QZFL.object.bind(this,function(){if(!rendered){rendered=true;this.current=current;this._render();}}),opt);if(ret!==false){this._pendingCallback=false;timeout&&clearTimeout(timeout);if(!rendered){rendered=true;this.current=current;this._render();}}else{return false;}};V.widget.mouseEventPager.prototype._render=function(){var tmpl=[];var pre=+this.opt.pre||0,post=+this.opt.post||0;if(this.total<=pre+post+1||this.opt.showAll){for(var i=1;i<=this.total;i++){tmpl.push(V.util.tmpl(i==this.current?this.tmpls.current:this.tmpls.number,{page:i,total:this.total}));}}else{var start=this.current-pre,end=this.current+post,endStatus=false;if(start<1){end+=1-start;start=1;}else if(end>this.total){start-=end-this.total;end=this.total;}
if(this.opt.showNumberFirstLast){if(start>=4){tmpl.push(V.util.tmpl(this.tmpls.number,{page:1,total:this.total}),V.util.tmpl(this.tmpls.omission));}else{start=1;}
if(end<=this.total-3){endStatus=true;}else{end=this.total;}}else if(this.opt.showOmission){if(start>=3){tmpl.push(V.util.tmpl(this.tmpls.omission));}else{start=1;}
if(end<=this.total-2){endStatus=true;}else{end=this.total;}}
for(var i=start;i<=end;i++){tmpl.push(V.util.tmpl(i==this.current?this.tmpls.current:this.tmpls.number,{page:i,total:this.total}));}
if(endStatus){tmpl.push(V.util.tmpl(this.tmpls.omission));if(this.opt.showNumberFirstLast){tmpl.push(V.util.tmpl(this.tmpls.number,{page:this.total,total:this.total}));}}}
this.pager.innerHTML=V.util.tmpl(this.tmpls.container,{pagerNumbers:tmpl.join(' '),firstPage:this.current==1?this.tmpls.firstDisabled:V.util.tmpl(this.tmpls.first,{page:1,total:this.total}),previousPage:this.current==1&&!this.opt.circle?this.tmpls.previousDisabled:V.util.tmpl(this.tmpls.previous,{page:this.current==1&&this.opt.circle?this.total:this.current-1,total:this.total}),nextPage:this.current==this.total&&!this.opt.circle?this.tmpls.nextDisabled:V.util.tmpl(this.tmpls.next,{page:this.current==this.total&&this.opt.circle?1:this.current+1,total:this.total}),lastPage:this.current==this.total?this.tmpls.lastDisabled:V.util.tmpl(this.tmpls.last,{page:this.total,total:this.total})});};window.V=window.V||{};V.widget=V.widget||{};V.widget.queuedFnCaller=function(fn,timeout,self,async){this._fn=fn;this._timeout=timeout||0;this._self=self||null;this._async=!!async;this._args=[];this._running=false;};V.widget.queuedFnCaller.prototype.run=function(){this._args.push(Array.prototype.slice.call(arguments,0));this._start();};V.widget.queuedFnCaller.prototype.complete=function(){if(!this._async||!this._running){return;}
this._runner();};V.widget.queuedFnCaller.prototype._start=function(){if(this._running){return;}
this._running=true;this._runner(1);};V.widget.queuedFnCaller.prototype._runner=function(skipTimeout){if(!this._args.length){this._running=false;return;}
setTimeout(QZFL.object.bind(this,function(){this._fn.apply(this._self,this._args.shift());if(!this._async){this._runner();}}),skipTimeout?0:this._timeout);};window.V=window.V||{};V.widget=V.widget||{};V.widget.imgDemandLoader={bind:function(opt){var _self=V.widget.imgDemandLoader;if(_self._opt){return;}
var defObj={context:window.document,exposurePercentage:50,statDomain:window.location.hostname,customHandler:[]};var lastWin=window,scrollWin,offset=0;try{do{scrollWin=lastWin;_self._bindResizeEvent(scrollWin);if(!scrollWin.frameElement||(scrollWin.frameElement.scrolling!='no'&&QZFL.dom.getClientHeight(scrollWin.document)<QZFL.dom.getScrollHeight(scrollWin.document))){_self._bindScrollEvent(scrollWin);defObj.topGetter=function(){return Math.max(0,QZFL.dom.getScrollTop(scrollWin.document)-offset);};defObj.bottomGetter=function(){return Math.min(QZFL.dom.getScrollTop(scrollWin.document)-offset+QZFL.dom.getClientHeight(scrollWin.document),Math.max(QZFL.dom.getScrollHeight(window.document),QZFL.dom.getClientHeight(window.document)));};break;}
lastWin=scrollWin.parent;offset+=QZFL.dom.getXY(scrollWin.frameElement,lastWin.document)[1];}while(scrollWin!=lastWin);}catch(_){defObj._err=1;}
_self._opt=opt=V.util.combine(defObj,opt);_self._imgs=QZFL.element.get('img[_demand="1"]',opt.context);_self.attachHandler(_self.showOriImg);if(opt.enableExposureStat&&V.widget.queuedFnCaller&&!opt._err){_self.attachHandler(_self.exposureStat);_self._qdFn=new V.widget.queuedFnCaller(function(){var args=Array.prototype.slice.call(arguments,0);setTimeout(function(){V.util.clickStat.apply(V.util,args);},2000);},100);}
_self.attachHandler(_self.removeTag);_self._eventHandler();},update:function(immediately){var _self=V.widget.imgDemandLoader;if(!_self._opt){_self.bind();return;}
_self._imgs=QZFL.element.get('img[_demand="1"]',_self._opt.context);if(immediately){_self._eventHandler();}},run:function(){var _self=V.widget.imgDemandLoader;if(!_self._opt){_self.bind();return;}
_self._eventHandler();},attachHandler:function(fn){if(typeof fn==='function'){V.widget.imgDemandLoader._handler.push(fn);}},showOriImg:function(el,percentage,_top,_bottom,pos){var oriSrc=el.getAttribute('_ori_src');if(oriSrc){el.src=oriSrc;el.removeAttribute('_ori_src');}},exposureStat:function(el,percentage,_top,_bottom,pos){var hotTag=el.getAttribute('_exposure_tag');var _self=V.widget.imgDemandLoader;var opt=_self._opt;if(hotTag&&percentage>=opt.exposurePercentage){hotTag=hotTag.split(';');for(var i=0,tag;tag=hotTag[i];i++){_self._qdFn.run(tag,opt.statDomain);}
el.removeAttribute('_exposure_tag');}},removeTag:function(el,percentage,_top,_bottom,pos){var _self=V.widget.imgDemandLoader;if(percentage>=100&&!el.getAttribute('_permanent')){el.removeAttribute('_demand');}},_opt:null,_handler:[],_imgs:null,_qdFn:null,_bindResizeEvent:function(win){QZFL.event.on(win,'resize',V.widget.imgDemandLoader._eventHandler);QZFL.event.on(window,'beforeunload',function(){QZFL.event.removeEvent(win,'resize',V.widget.imgDemandLoader._eventHandler);});},_bindScrollEvent:function(win){QZFL.event.on(win,'scroll',V.widget.imgDemandLoader._eventHandler);QZFL.event.on(window,'beforeunload',function(){QZFL.event.removeEvent(win,'scroll',V.widget.imgDemandLoader._eventHandler);});},_eventHandler:function(){setTimeout(function(){try{var _self=V.widget.imgDemandLoader;var _top=_self._opt._err?0:_self._opt.topGetter(),_bottom=_self._opt._err?QZFL.dom.getClientHeight():_self._opt.bottomGetter();if(_top>=_bottom){return;}
_self._imgs.each(function(el){if(el.parentNode){var pos=QZFL.dom.getPosition(el);pos.bottom=pos.top+pos.height;pos.right=pos.left+pos.width;if(pos.top<=_bottom&&pos.bottom>=_top){var percentage=_bottom>=pos.bottom?_top<=pos.top?100:Math.round((pos.bottom-_top)*100/pos.height):Math.round((_bottom-pos.top)*100/pos.height);for(var i=0,fn;fn=_self._handler[i];i++){fn.call(el,el,percentage,_top,_bottom,pos);}
for(var i=0,one;one=_self._opt.customHandler[i];i++){if(one.el==el){one.handler.call(el,el,percentage,_top,_bottom,pos);}}}}});_self.update();}catch(_){}},0);}};VC.interface={callExt:function(fnName,args){var t=this;if(!QZFL.lang.isArray(args)){args=[args];}
if(typeof t[fnName]=="function"){t[fnName].apply(t,args);}else{QZFL.imports(t.extUrl,function(){t[fnName].apply(t,args);});}}}
QZFL.object.extend(VC.util,{go:function(url,data){if(data){url+=genHttpParamString(data);}
location.href=url;}});VC.profile={show:function(container){var uin=QZONE.FP.getQzoneConfig("ownerUin");var _t=QZONE.FP._t;var data={icon:QZONE.FP.getPURL(uin,50),uin:uin,nickname:escHTML(QZONE.FP.getNickname()),vipStatus:QZONE.FP.getVipStatus(),vipLevel:(QZONE.FP.getUserVIPLevel()||0),process:((_t.g_JData&&_t.g_JData.yellowInfo&&_t.g_JData.yellowInfo.ownerinfo&&_t.g_JData.yellowInfo.ownerinfo[0].charmpercent)||0)};$("profile").innerHTML=VC.tmpl.get("profile",data);}};(function(){VC.event={onClick:QZFL.emptyFn,init:function(){QZFL.event.addEvent(document.body,"click",VC.event.clickProxy);},clickProxy:function(e){var target=QZFL.event.getTarget(e);QZFL.dom.searchChain(target,"parentNode",function(o){var el=$e(o);if(el.hasClass("btn_search")){return true;}});t.onClick(e);},bindHashChange:function(fn){if(('onhashchange'in window)&&((typeof document.documentMode==='undefined')||document.documentMode==8)){window.onhashchange=fn;}else{t.hash=location.hash;t.onHashChange=fn||QZFL.emtpyFn;QZFL.event.addEvent(document.body,'click',t.checkHashChange);}},checkHashChange:function(e){setTimeout(function(){if(location.hash!=t.hash){t.hash=location.hash=location.hash+"&_t="+Math.random();t.onHashChange();}},0);}};var t=VC.event;})()
VC.widget={loadPager:function(cb){window.F4A=window.F4A||{};QZFL.imports("http://"+QZONE.FP._t.siDomain+"/qzone/app/controls/pager/pager.js",cb);}};VC.pageStart=function(cb){cb();VC.event.bindHashChange(function(){VC.stat.pv();cb();VC.util.setScrollTop();});VC.event.init();VC.stat.pv();VC.util.setScrollTop();};VC.net={dataLoader:function(url,data,sucCb,errCb,options){var arg=arguments;options=options||{};sucCb=sucCb||QZFL.emptyFn;errCb=errCb||QZFL.emptyFn;options.url=url;options.param=data;options.onSuccess=function(d){if(d.ret==0){sucCb(d);}else if(d.ret==-100){QZONE.FP.showLoginBox("app",function(){if(parent.QZFL.cookie.get("uin")){arg.callee.apply(null,arg);}else{d.msg=d.msg||"对不起，服务繁忙，请稍候再试！";errCb(d);}});}else{d.msg=d.msg||"对不起，服务繁忙，请稍候再试！";errCb(d);}};options.onError=function(){var d={"ret":"9999","msg":"对不起，网络繁忙，请稍候再试！"};errCb(d);};V.util.loadJson(options);}};;!function(){QZFL.object.extend(VC.util,{getEpisodeInf:function(item){var ep=item.episode||'';if(item.episode_total==1)ep='';if(item.is_preview){return"预告片"+ep;}
if(item.episode){if(item.type==2||item.type==4){if(ep){return'第'+item.episode+'集';}}else if(item.type==3){return item.episode+'期';}}
return'';}});}();(function(){VC.topSearch={init:function(container){container=container||"topSearch";t.el=$e("#"+container);$e("#btn_search").bind("click",t.submit);$e("#topSearchKw").bind("keydown",function(e){if(e.keyCode==13){t.submit();}});VC.searchTips.init(container,t.submit);},submit:function(v){var kw=QZFL.string.trim($('topSearchKw').value);if(kw==''||kw=='搜索…')return;if(QZONE.FP&&QZONE.FP.getACSRFToken){VC.util.go('http://vc.qq.com/cgi-bin/video_search_info.cgi?',{search:kw,domain:2,cb:"_Callback",g_tk:QZONE.FP.getACSRFToken()});}else{window.open('http://rc.qzone.qq.com/appsetup/video/search/'+encodeURIComponent(kw));}}};var t=VC.topSearch;})();(function(){VC.searchTips={init:function(container,onSelect){container=container||"topSearch";t.el=$e("#"+container);$e("#topSearchKw").bind("keyup",t.get).bind("focus",t.get).bind("keydown",t.keyDown);$e("#kwTipsList").bind("click",t.select);$e("#kwTipsList").bind("mouseover",t.mouseover);t.onSelect=onSelect||QZFL.emptyFn;},get:function(){clearTimeout(t.timer);t.timer=setTimeout(t.getTips,300);},getTips:function(){var kw=trim($e("#topSearchKw").getAttr("value"));if(!kw.length||kw==t.kw||t.change){t.change=0;return;}
t.kw=kw;var url='http://vc.qq.com/cgi-bin/video_search_name.cgi';var data={search:kw,domain:1,cb:'_Callback'};VC.net.dataLoader(url,data,function(d){var items=d.result||[];if(items.length){t.showTips(items);}else{t.hideTips();}},function(d){t.hideTips();});},showTips:function(items){t.items=items;t.idx=-1;var html=[];for(var i=0;i<items.length;++i){html.push('<li class="kwList" idx="kwList">'+items[i].appalias+'</li>');}
$e("#kwTipsList").setHtml(html.join(""));$e("#kwTips").setStyle('display','');$e(document.body).bind("click",t.hideTips);},hideTips:function(){t.items=null;t.kw=null;$e("#kwTips").setStyle('display','none');$e(document.body).unBind("click",t.hideTips);},keyDown:function(e){if(t.items){var idx=t.idx;if(e.keyCode==38){t.idx=Math.max(t.idx,0);var idx=(t.idx+t.items.length-1)%t.items.length;}else if(e.keyCode==40){var idx=(t.idx+t.items.length+1)%t.items.length;}
if(idx!=t.idx){t.idx=idx;$e('#kwTipsList .current').removeClass("current");var el=t.el.find("li").elements[t.idx];$e(el).addClass("current");$e("#topSearchKw").setAttr("value",el.innerHTML);t.change=1;}}},select:function(e){var target=QZFL.event.getTarget(e);if($e(target).hasClass("kwList")){var v=target.innerHTML;$e("#topSearchKw").setAttr("value",v);t.onSelect(v);}},mouseover:function(e){var target=QZFL.event.getTarget(e);if($e(target).hasClass("kwList")){$e('#kwTipsList .current').removeClass("current");$e(target).addClass("current");}}};var t=VC.searchTips;})();﻿!function(){VC.stat={pv:function(){var tc=QZONE.FP.getStatPackage();tc.pv('appstore.qzone.qq.com',(location.pathname||'').replace(/^\/qzone\/vas\/app|^\/cgi-bin|^\//i,'/v2'));},exposed:{},exposureStat:function(flag,values){if(VC.stat.exposed[flag]){return;}
var params={t:new Date().getTime()};VC.stat.exposed[flag]=true;VC.stat.actionStat(values);},actionStat:function(values){var params={t:new Date().getTime()};if(window.PARAM){if(PARAM.vid){params.itemid=PARAM.vid;}
if(PARAM.category){params.itemtype=PARAM.category;}
if(PARAM.provider){params.party_id=PARAM.provider;}}
if(values){QZFL.extend(params,values);var url='http://vc.qq.com/cgi-bin/video_stat.cgi?'+QZFL.util.genHttpParamString(params);var img=new Image();img.src=url;setTimeout(function(){},1000);}},srcReport:function(){var source=VC.util.getHttpParams("source");return function(){};}()};var TimeStat=function(){this.stamps=[];}
TimeStat.prototype={mark:function(){this.stamps.push(new parent.Date());},insert:function(arr){this.stamps=arr.concat(this.stamps);},append:function(arr){this.stamps=this.stamps.concat(arr);},report:function(id){if(this.stamps.length>1){var timeStat=QZONE.FP.getStatPackage().createTimeStat("moodPageTime"+id,[175,367,id]);timeStat.zero=this.stamps[0];timeStat.timeStamps=this.stamps;timeStat.report();}}};VC.stat.Time=TimeStat;}();(function(){var d=t.recordData;var record={init:function(){if(d){controller.record.scroller=new scroller("c_simscrollbox");if(d.msgcount){$e('#msgCount').setHtml('<b>'+t.recordData.msgcount+'</b>').setStyle('display','');}
$e('#record .mod_user_op_tab .changeTab').bind("click",function(){var newType=$e(this).getAttr("type");if(t.recordConfig.type==newType){return;}
var msgCount=$('msgCount');if(msgCount){msgCount.parentNode.removeChild(msgCount);}
t.recordData.msgcount=0;record.show(newType);});record.show(t.recordConfig.type);}},show:function(listType){if(/^subscribe$/i.test(listType)){record.showSubscribe();}else{record.showHistory();}},showHistory:function(){record.showList('history');},showSubscribe:function(){record.showList('subscribe');},showList:function(listType){if(/msie [67]/i.test(navigator.userAgent))$e('#record').hide();record[t.recordConfig.type+"ScrollTop"]=$('c_simscrollbox_container').scrollTop;t.recordConfig.type=listType;var from=listType=='subscribe'?'msg':'record';$e('#record .mod_user_op_tab .changeTab').removeClass('current');$e('#record .mod_user_op_tab .changeTab[type='+listType+']').addClass('current');var list=d[listType+'_data']||[];if(list.length>2){$e('#historyList').removeClass('no_scroll');}else if(list.length>1){$e('#historyList').addClass('no_scroll');}else{}
if(list.length>=2){$e('#subscribeList ol').setHtml(VC.tmpl.get('subscribeItem',{list:list,from:from,msgcount:t.recordData.msgcount}));$('record').className='mod_user_op user_op_history';$('c_simscrollbox_container').scrollTop=record[listType+"ScrollTop"]||0;record.scroller.resetRight();}else{if(list.length>0){$e('#historyHot .vList').setHtml(VC.tmpl.get('subscribeItem',{list:list,from:from,msgcount:t.recordData.msgcount}));$e('#historyHot .emptyTips');$('record').className='mod_user_op user_op_history_less';}else{;$('record').className='mod_user_op user_op_no_history';$e('#historyHot .emptyTips').setHtml(listType=='history'?'你的播放记录为空':"没有消息记录");}
record.loadHotData(function(data){var element=$e('#historyHot .mod_user_op_recommend').eq(0);element.innerHTML=VC.tmpl.get('historyHot',{list:data.slice(0,list.length>0?5:6)});window.tcssStat&&window.tcssStat.exposureStatUpdate(element);});}
if(/msie [67]/i.test(navigator.userAgent)){setTimeout(function(){$e('#record').show();window.tcssStat&&window.tcssStat.exposureStatUpdate($('record'));},16);}else{window.tcssStat&&window.tcssStat.exposureStatUpdate($('record'));}},del:function(idx){var items=d[t.recordConfig.type+"_data"];var item=items[idx];var url=config.url.uptMySubscribe;var data={cmd:3,vids:item.vid,msg_type:item.msg_type};var valueStatId=config.valueStatId.uptMySubscribe;if(t.recordConfig.type=="history"){url=config.url.uptMyHistory;data={cmd:0,vids:item.vid};valueStatId=config.valueStatId.uptMyHistory;}
VC.net.dataLoader(url,data,function(){items.splice(idx,1);if(idx<t.recordData.msgcount){t.recordData.msgcount--;if(t.recordData.msgcount){$e('#msgCount').setHtml('<b>'+t.recordData.msgcount+'</b>');}else{var msgCount=$('msgCount');if(msgCount){msgCount.parentNode.removeChild(msgCount);}}}
controller.record.show(t.recordConfig.type);},function(){},{valueStatId:valueStatId});},hotData:null,loadHotData:function(callback){if(record.hotData)return callback(record.hotData);var url=config.url.videoTop;VC.net.dataLoader(url,{},function(d){controller.record.hot=d.data.weekHot;record.hotData=controller.record.hot||[];callback(record.hotData);},QZFL.emptyFn,{valueStatId:config.valueStatId.videoTop});}};t.record=record;function isBTypeUser(){return d.category_data&&d.category_data.length&&d.category_data.length>1&&V.util.getUin()%2==1;}
if(isBTypeUser()){function findViewed(item){var list=arguments.callee._list=arguments.callee._list||[].concat(d.history_data||[]);for(var i=0;i<list.length;i++){if(item.sub_type==list[i].sub_type){var findOut=list.splice(i,1);arguments.callee._list=list.concat(findOut);return findOut[0];}}}
for(var i=0;i<d.category_data.length;i++){var item=d.category_data[i];item.viewed=findViewed(item);}
var typesList={};for(var i=0;i<d.category_data.length;i++){var item=d.category_data[i];typesList['T'+item.sub_type]=typesList['T'+item.sub_type]||[];typesList['T'+item.sub_type].push(item);}
var category_data=[];for(var p in typesList){category_data.push(typesList[p]);}
var list=[];while(true){if(!category_data.length)break;var a=category_data[0];list.push(a.shift());if(a.length){category_data.push(category_data.shift());}else{category_data.shift();}}
record.replaceMayLike=function(){$e('#historyHot .mod_user_op_recommend_v2').setHtml(VC.tmpl.get('mayLike',{list:list,allCount:d.category_data.length}));list=list.concat(list.splice(0,2));};var historyFirst=true;record.showHistory=function(){if(/msie [67]/i.test(navigator.userAgent))$e('#record').hide();record[t.recordConfig.type+"ScrollTop"]=$('c_simscrollbox_container').scrollTop;t.recordConfig.type='history';$e('#record .mod_user_op_tab .changeTab').removeClass('current');$e('#record .mod_user_op_tab .changeTab[type=history]').addClass('current');var list=d.history_data||[];$e('#subscribeList ol').setHtml('');if(list.length>4){$e('#historyList').removeClass('no_scroll');}else{$e('#historyList').addClass('no_scroll');}
$e('#c_simscrollbox_shower .mod_user_op_text_list ol').setHtml(VC.tmpl.get('historyItem',{list:list,from:'record',msgcount:t.recordData.msgcount}));if(historyFirst){record.replaceMayLike();historyFirst=false;}
if(list.length>0){$('record').className='mod_user_op user_op_history_v2';}else{$('record').className='mod_user_op user_op_no_history_v2';}
if(/msie [67]/i.test(navigator.userAgent)){setTimeout(function(){$e('#record').show();window.tcssStat&&window.tcssStat.exposureStatUpdate($('record'));},32);}else{window.tcssStat&&window.tcssStat.exposureStatUpdate($('record'));}};}})();!function(){controller.hotRecommend={cates:['syncTv','recentFilm','americanTv','popularShow'],Item:function(list,typeName,element){var item=this;this.playIndex=0;this.list=list;this.interval=0;this.play=function(){$e('div.bd ul',element).setHtml(VC.tmpl.get("hotRecommend",{list:list.slice(this.playIndex,this.playIndex+2),typeName:typeName}));this.playIndex=(this.playIndex+2)%this.list.length;return this;};this.stop=function(){clearInterval(this.interval);return this;};this.start=function(){this.interval=setInterval(function(){item.play();tcssStat.exposureStatUpdate(element);},60*1000);return this;};this.play().start();$e('a.btn_s1',element).bind('click',function(){item.stop().play().start();tcssStat.exposureStatUpdate(element);});},init:function(){var c=controller;var t=c.hotRecommend;if(!c.d||!c.d.data)return;QZFL.each(t.cates,function(item){var propertyName=VC.util.camelize('recommend',item);list=controller.d.data[propertyName];if(list){new t.Item(list,item,$e('.mod_popular_recommend_item[category='+item+']').eq(0));}});}};}();!function(){controller.personalized={gender:(QZONE&&QZONE.FP&&QZONE.FP.getGender)?(QZONE.FP.getGender()?1:2):3,titles:[['男生最爱top5','热血战争top5','伦理犯罪top5'],['女生最爱top5','感人韩剧top5','青春偶像top5'],['网友关注top5','搞笑喜剧top5','都市情感top5']],init:function(){var c=controller;if(!c.d||!c.d.data)return;var p=controller.personalized;var titles=p.titles[p.gender-1];$e('#tabPersonalized h3').each(function(e,i){this.parentNode.setAttribute('_click_tag',"VC.TOP5.TAB.CLICK."+((p.gender-1)*3+i));this.innerHTML=titles[i];});$e('#top5List').setHtml(VC.tmpl.get('top5',{'list':c.d.data.gender1||[],'tabIndex':(p.gender-1)*3+0}));$e('#tabPersonalized li a').each(function(e,i){var tab=(p.gender-1)*3+i;$e(this).bind('click',function(){var propertyName='gender'+(i+1);$e('#top5List').setHtml(VC.tmpl.get('top5',{'list':c.d.data[propertyName]||[],'tabIndex':tab}));$e('#tabPersonalized li a').removeClass('current');$e(this).addClass('current');tcssStat.exposureStatUpdate($('top5List'));});});}};}();!function(){var c=controller;c.exclusive={init:function(){if(!c.d||!c.d.data||!c.d.data.exclusive){return;}
$e('#exclusive .bd ul').setHtml(VC.tmpl.get("exclusive",{list:c.d.data.exclusive}));$e('#exclusive').eq(0).style.display='';}};}();!function(){controller.channel={cates:['cartoon','film','show','tv'],gid:{'cartoon':'xx83054914456900815','film':'xx83054914456900815','show':'xx83054914456900815','tv':'xx83054914456900813'},defaultAd:{'film':{'img':'images/ad/ad_right_film.jpg','txt':'亲，再丑也要记得谈恋爱！','link':'http://rc.qzone.qq.com/myhome/33024'},'tv':{'img':'images/ad/ad_right_tv.png','txt':'给美女打分，不打不相识！','link':'http://rc.qzone.qq.com/myhome/28594'}},init:function(){controller.channel.initDetail();controller.channel.initHot();controller.channel.initFilter();controller.channel.initMain();controller.channel.initAd();},initAd:function(){if(false&&!window.GDT){QZFL.imports("http://"+parent.siDomain+"/qzone/biz/comm/js/qbs.js",controller.channel.initAd);return;}
QZFL.each(['film','tv'],function(name){var data=controller.channel.defaultAd[name];data.defLink='href="'+data.link+'" target="_blank"';var htm=VC.tmpl.get("ad",{items:[data],id:0});$e('.section_channel[category='+name+'] .section_channel_side .mod_channel_side_ad').setHtml(htm);return;var gid=controller.channel.gid[name];GDT.get(gid,null,1,false,function(d){if(d&&d.ret){var htm=VC.tmpl.get("ad",{items:d.data,id:d.cfg.p});$e('.section_channel[category='+name+'] .section_channel_side .mod_channel_side_ad').setHtml(htm);GDT.viewpos(gid);}else{var data=controller.channel.defaultAd[name];data.defLink='href="'+data.link+'" target="_blank"';var htm=VC.tmpl.get("ad",{items:[data],id:0});$e('.section_channel[category='+name+'] .section_channel_side .mod_channel_side_ad').setHtml(htm);}},{count:1});});},initMain:function(){var c=controller;if(!c.d||!c.d.data)return;var tabs={'tv':[{'name':'美剧','ps':{'category':'2','type':'1100','area':'1206','year':'1'}},{'name':'偶像','ps':{'category':'2','type':'1101','area':'1200','year':'1'}},{'name':'爱情','ps':{'category':'2','type':'1103','area':'1200','year':'1'}},{'name':'都市','ps':{'category':'2','type':'1104','area':'1200','year':'1'}},{'name':'TVB','ps':{'category':'2','type':'1117','area':'1200','year':'1'}},{'name':'韩国','ps':{'category':'2','type':'1100','area':'1205','year':'1'}}],'film':[{'name':'喜剧','ps':{'category':'1','type':'103','area':'200','year':'1'}},{'name':'爱情','ps':{'category':'1','type':'104','area':'200','year':'1'}},{'name':'动画','ps':{'category':'1','type':'113','area':'200','year':'1'}},{'name':'伦理','ps':{'category':'1','type':'117','area':'200','year':'1'}},{'name':'动作','ps':{'category':'1','type':'101','area':'200','year':'1'}}],'cartoon':[{'name':'少女','ps':{'category':'4','type':'3103','area':'3200','year':'3300'}},{'name':'剧情','ps':{'category':'4','type':'3109','area':'3200','year':'3300'}},{'name':'推理','ps':{'category':'4','type':'3105','area':'3200','year':'3300'}},{'name':'热血','ps':{'category':'4','type':'3101','area':'3200','year':'3300'}},{'name':'搞笑','ps':{'category':'4','type':'3102','area':'3200','year':'3300'}}],'show':[{'name':'选秀','ps':{'category':'3','type':'2103','area':'2200','year':''}},{'name':'脱口秀','ps':{'category':'3','type':'2101','area':'2200','year':''}},{'name':'搞笑','ps':{'category':'3','type':'2108','area':'2200','year':''}},{'name':'生活','ps':{'category':'3','type':'2114','area':'2200','year':''}}]};function bindTabHover(btn,category,params,ol,list){var timeout=0;$e(btn).onHover(function(){if(/\bcurrent\b/i.test(this.className))return;var args=arguments;if(list==null){var page_num=(/^(show|cartoon)$/i.test(category)?8:12);var data=QZFL.extend({detail:0,page_num:page_num,page:1,orderby:1},params);return VC.net.dataLoader(config.url.getAll,data,function(d){list=d.data;args.callee.apply(btn,args);},function(){var b=btn.previousSibling;b.parentNode.removeChild(b);btn.parentNode.removeChild(btn);},{valueStatId:config.valueStatId.getAll});}
ol.setHtml(VC.tmpl.get('channelMain',{list:list,categoryName:category}));$e('.section_channel[category='+category+'] .section_channel_main .hd .nav_tabs li.current').removeClass('current');$e(this.parentNode).addClass('current');clearTimeout(timeout);timeout=setTimeout(function(){tcssStat.exposureStatUpdate(ol.eq(0));},1000);},QZFL.emptyFn);}
QZFL.each(controller.channel.cates,function(name){var property=VC.util.camelize('recommend',name);var list=c.d.data[property]||[];var eleTabs=$e('.section_channel[category='+name+'] .section_channel_main .hd .nav_tabs').eq(0);var ol=$e('.section_channel[category='+name+'] .mod_channel_video_list ul');if(list){ol.setHtml(VC.tmpl.get('channelMain',{list:list,categoryName:name}));bindTabHover($e('a',eleTabs),name,null,ol,list);}
QZFL.each(tabs[name],function(tab,index){eleTabs.appendChild(document.createTextNode(" "));var btn=document.createElement('a');btn.href='javascript:void(0)';btn.setAttribute('_click_tag','VC.SEC_'+name.toUpperCase()+'.TAB.CLICK.'+(1+index));btn.innerHTML=tab.name;var li=document.createElement('li');li.appendChild(btn);eleTabs.appendChild(li);bindTabHover(btn,name,tab.ps,ol);});});},initDetail:function(){var c=controller;if(!c.d||!c.d.data||!c.d.data.recommendDetail)return;var idx={'film':'1','tv':'2','show':'3','cartoon':'4'};QZFL.each(controller.channel.cates,function(name){var dataId=idx[name];var data=c.d.data.recommendDetail[dataId];if(data){var ol=$e('.section_channel[category='+name+'] .col_channel_side .mod_video_detail');if(name=='show'){delete data.summary;}
if(name=='cartoon'){delete data.directors;delete data.actors;}
ol.setHtml(VC.tmpl.get('videoDetail',{item:data,categoryName:name}).replace(/<\/span><span\b/ig,"</span> <span"));}});},category:{"film":{"id":"1","type":{"name":"类型","101":"动作","102":"冒险","103":"喜剧","104":"爱情","105":"战争","106":"恐怖","107":"犯罪","108":"悬疑","109":"惊悚","110":"武侠","111":"科幻","112":"音乐","113":"动画","114":"奇幻","115":"家庭","116":"剧情","117":"伦理","118":"记录","119":"历史"},"area":{"name":"地区","202":"内地","203":"港台","204":"日韩","205":"欧美","201":"其他",'sort':[202,203,204,201]},"year":{"name":"时间","2012":"2012","2011":"2011","2010":"2010","2009":"2009",'sort':['2012','2011','2010','2009']}},"tv":{"id":"2","area":{"name":"地区","1202":"内地","1203":"香港","1204":"台湾","1205":"韩国","1206":"美剧","1201":"其他",'sort':'1202,1203,1204,1205,1206,1201'.split(',')},"type":{"name":"类别","1101":"偶像","1102":"喜剧","1103":"爱情","1104":"都市","1105":"古装","1106":"武侠","1107":"历史","1108":"警匪","1109":"家庭","1110":"神话","1111":"剧情","1112":"悬疑","1113":"战争","1115":"犯罪","1116":"情景","1117":"TVB"},"year":{"name":"时间","2012":"2012","2011":"2011","2010":"2010","2009":"2009",'sort':['2012','2011','2010','2009']}},"show":{"id":"3","type":{"name":"类型","2108":"搞笑","2102":"竞技","2103":"选秀","2104":"美食"},"area":{"name":"电视台","2202":"湖南卫视","2203":"江苏卫视","2204":"台湾综艺","2205":"东方卫视","2206":"浙江卫视","2207":"天津卫视","2209":"安徽卫视","2212":"深圳卫视","2213":"北京卫视"}},"cartoon":{"id":"4","type":{"name":"类型","3101":"热血","3102":"搞笑","3103":"少女","3104":"魔幻","3105":"推理","3107":"益智","3108":"经典","3109":"剧情"},"area":{"name":"地区","3202":"内地","3203":"日韩","3204":"欧美","3201":"其他",'sort':[3202,3203,3204,3201]}}},initFilter:function(){var cs=controller.channel.category;QZFL.each(controller.channel.cates,function(name){var ol=$e('.section_channel[category='+name+'] .mod_video_filter');ol.setHtml(VC.tmpl.get("videoFilter",{categories:controller.channel.category[name],categoryName:name}).replace(/<\/a><a\b/g,'</a> <a'));});},initHot:function(){var c=controller;if(!c.d||!c.d.data)return;QZFL.each(controller.channel.cates,function(cateName){var ol=$e('.section_channel[category='+cateName+'] .section_channel_side .bd ol');var list=[].concat(controller.d.data[VC.util.camelize('hot',cateName)]);var htm=[];QZFL.each(list.splice(0,3),function(item,i){if(!item)return;htm.push(VC.tmpl.get('hotTop3',{item:item,index:i,categoryName:cateName}));});var page_num=(/^(show|cartoon)$/i.test(cateName)?5:7);QZFL.each(list.splice(0,page_num),function(item,i){htm.push(VC.tmpl.get('hotTop10',{item:item,index:i+3,categoryName:cateName}));});ol.setHtml(htm.join(''));});}};}();!function(){var funcs=[];QZFL.object.extend(controller,{onInit:function(func){funcs.push(func);},init:function(){controller.record.init();controller.channel.init();controller.hotRecommend.init();controller.personalized.init();controller.exclusive.init();VC.topSearch.init();while(funcs.length){funcs.shift()();}
tcssStat.init();}});}();;(controller.d&&controller.d.data&&controller.d.data.abtest_round?function(){var listAds=[],index=0,timeout;var def=[{'name':'飞虎神鹰','img':'http://qzonestyle.gtimg.cn/qzone/vas/app/video_center/images/ad/slide_v2_1.jpg','diectors':['钱雁秋'],'actors':['张子健','梁冠华','曲栅栅','苑冉','须乾'],'friendInfo':[],'friendPlay':0,'totalPlay':0,'point':'铁流小组组长张桥付出了生命的代价保护了燕双鹰','vid':17480,'svid':1472281,'provider':4103},{'name':'金陵十三钗','img':'http://qzonestyle.gtimg.cn/qzone/vas/app/video_center/images/ad/slide_v2_2.jpg','diectors':['张艺谋'],'actors':['克里斯汀·贝尔','佟大为','窦骁','黄海波','曹可凡','聂远','倪妮'],'friendInfo':[],'friendPlay':0,'totalPlay':0,'point':'张艺谋抗日大片','vid':17752,'svid':1467986,'provider':4102},{'name':'守望的天空','img':'http://qzonestyle.gtimg.cn/qzone/vas/app/video_center/images/ad/slide_v2_3.jpg','diectors':['陆江'],'actors':['赵文瑄','李沁','阚清子','林申','李艳','萨日娜','王琳'],'friendInfo':[],'friendPlay':0,'totalPlay':0,'point':'都市剧情','vid':17754,'svid':1473182,'provider':4102}];var ad={init:function(){var data=controller.d.data.roundAd_Ex||def;if(data.length<3)data=data.concat(def).slice(0,3);$e('#slide').setHtml(VC.tmpl.get('slideV2',{groupCount:parseInt(data.length/3)}));var group=0;while(data.length>=3&&group<5){listAds.push(createAdList(data.splice(0,3),group++));}
index=-1;ad.play(0);},playNext:function(){ad.play(index+1);},play:function(idx){if(!listAds.length){return;}
clearTimeout(timeout);idx=idx%listAds.length;if(index==idx)return;index=idx;var layer=$('slide');layer.removeChild(layer.firstChild);layer.insertBefore(listAds[idx%listAds.length],layer.firstChild);$e('#slide ul.slide_list li.hover').removeClass('hover');$e('#slide .slide_page_nav a.current').removeClass('current');$e('#slide .slide_page_nav a').eq(idx).className='current';timeout=setTimeout(ad.playNext,2000);window.tcssStat&&tcssStat.exposureStatUpdate($("slide").firstChild);},stop:function(){clearTimeout(timeout);},start:function(){timeout=setTimeout(ad.playNext,2000);}};controller.slideAd=ad;controller.onInit(ad.init);var btnCount=0;function createAdList(items,group){var ul=document.createElement('ul');ul.className='slide_list';ul.innerHTML=VC.tmpl.get('slideItemV2',{list:items,group:group});$e('li',ul).onMouseEnter(function(){this.className='hover';}).onMouseLeave(function(){this.className='';});return ul;}}:function(){var def=[{"actors":["巍子","王全有","杜源","王奎荣","姚笛","崔林"],"img":"http://qzonestyle.gtimg.cn/qzone/vas/app/video_center/images/ad/slide1.jpg","name":"光荣大地","point":"巍子姚笛父女情深","provider":4103,"svid":1424822,"vid":16678},{"actors":"秦岚 刘恺威 王妍苏 TAE 方安娜".split(" "),"img":"http://qzonestyle.gtimg.cn/qzone/vas/app/video_center/images/ad/slide2.jpg","name":"大唐女将樊梨花[超清版]","point":"秦岚上演夺夫大战","provider":4100,"svid":1425505,"vid":16707},{"actors":"何润东 宋佳 梁家辉 何晟铭".split(" "),"img":"http://qzonestyle.gtimg.cn/qzone/vas/app/video_center/images/ad/slide3.jpg","name":"遍地狼烟","point":"何润东情迷小宋佳","provider":4103,"svid":1422751,"vid":16715},{"actors":['文章','白百何','张子萱','王耀庆','郭京飞','张嘉译'],"img":"http://qzonestyle.gtimg.cn/qzone/vas/app/video_center/images/ad/slide4.jpg","name":"失恋33天","point":"文章白百何仙贱缘","provider":4103,"svid":1414802,"vid":16602},{"actors":["曾黎","王雅捷","柳云龙","曾江","午马","申军谊","王媛可","雷佳音","周大勇"],"img":"http://qzonestyle.gtimg.cn/qzone/vas/app/video_center/images/ad/slide5.jpg","name":"传奇之王","point":"中国版基督山伯爵","provider":4100,"svid":1424559,"vid":16676}];function loadImg(url,cb){var img=new Image();img.onload=img.onerror=function(){img.onload=img.onerror=null;img=null;cb();}
img.src=url;}
var ad={init:function(){t.slideData=(t.slideData||[]).concat(def).slice(0,5);$e("#slide").onHover(function(e){var target=QZFL.event.getTarget(e);var idx=$e(target).getAttr("idx");if(idx==t.slideIdx)return;if(t.slideData&&t.slideData[idx]){t.slideIdx=idx;$("slide").innerHTML=VC.tmpl.get("slide",{item:t.slideData[t.slideIdx],curIdx:t.slideIdx});var item=t.slideData[t.slideIdx];VC.stat.exposureStat('V'+item.vid,{optype:5,actionid:2001,party_id:item.provider,itemid:item.vid});}
ad.stop();},function(e){ad.start();});ad.start();},start:function(){ad.isStop=false;ad.loop();},stop:function(){ad.isStop=true;clearTimeout(ad.timer);},loop:function(){clearTimeout(ad.timer);if(!t.slideData){return;}
ad.timer=setTimeout(function(){var idx=((t.slideIdx>-1?t.slideIdx:-1)+1)%t.slideData.length;var item=t.slideData[idx];if(!item)return;loadImg(item.img,function(){if(!ad.isStop){t.slideIdx=idx;$("slide").innerHTML=VC.tmpl.get("slide",{item:t.slideData[t.slideIdx],curIdx:t.slideIdx});var item=t.slideData[t.slideIdx];VC.stat.exposureStat('V'+item.vid,{optype:5,actionid:2001,party_id:item.provider,itemid:item.vid});window.tcssStat&&tcssStat.exposureStatUpdate($("slide"));ad.loop();}});},2000);}};controller.slideAd=ad;controller.onInit(ad.init);})();!function(){var friendTrend={playIndex:0,interval:0,init:function(){var t=controller.friendTrend;var d=controller.friendTrendData;if(true||!d||d.length<5){controller.friendTrend.appendComments();}
if(!controller.friendTrendData)return;controller.friendTrend.showList(controller.friendTrendData);;setTimeout(t.bind,0);},bind:function(){$e('#mod_everyone_watch').onHover(function(){$e(this).addClass('mod_everyone_watch_hover');},function(){$e(this).removeClass('mod_everyone_watch_hover');});var t=controller.friendTrend;t.interval=setInterval(function(){t.play(1);},3000);$e('#btnFriendTrendPrev').bind('click',function(){clearInterval(t.interval);t.play(-5);t.interval=setInterval(function(){t.play(1);},3000);});$e('#btnFriendTrendNext').bind('click',function(){clearInterval(t.interval);t.play(5);t.interval=setInterval(function(){t.play(1);},3000);});$e('#mod_everyone_watch .btnRefresh').bind('click',function(){friendTrend.refresh();}).show();},play:function(n){var t=controller.friendTrend;var d=controller.friendTrendData;if(d.length<=5)return;var c=$('friendTrend');var p=c.parentNode;var i=1;var scrollHeight=p.scrollHeight*0.5;var itemHeight=scrollHeight/d.length;var oTop=p.scrollTop;oTop=(oTop/itemHeight).toFixed(0)*itemHeight;!function(){if(i>10){p.scrollTop=(((oTop+n*itemHeight)%scrollHeight)+scrollHeight)%scrollHeight;}else{var sTop=oTop+parseInt(n*itemHeight*0.1*i);p.scrollTop=((sTop%scrollHeight)+scrollHeight)%scrollHeight;i++;timeout_scroller=setTimeout(arguments.callee,100);}}();},showList:function(ary){var strHTML=VC.tmpl.get('friendTrend',{list:ary});if(ary.length>5){strHTML=strHTML+strHTML;}
$('friendTrend').innerHTML=strHTML;},appendComments:function(){function onSuc(commenetsData){var ary=[].concat(controller.friendTrendData||[]).concat(commenetsData);if(!controller.friendTrendData||controller.friendTrendData.length<5){controller.friendTrendData=ary;controller.friendTrend.showList(ary);tcssStat.exposureStatUpdate($('friendTrend'));}}
if(commenetsData){return onSuc(commenetsData);}
VC.net.dataLoader(config.url.topComment,{},function(d){if(d&&d.ret==0&&d.data&&d.data.weekHot){commenetsData=d.data.weekHot;onSuc(commenetsData);}},QZFL.emptyFn,{valueStatId:config.valueStatId.topComment});},refresh:function(){var onErr=function(){QZONE.FP.showMsgbox("服务器繁忙，请稍后再试。",5,2000);};var onSuc=function(data){data=data.friendTrend;clearInterval(timeout_scroller);clearTimeout(controller.friendTrend.interval);controller.friendTrendData=data;if(!data||data.length<5){setTimeout('controller.friendTrend.appendComments()',0);}
controller.friendTrend.showList(data);$('friendTrend').parentNode.scrollTop=0;controller.friendTrend.interval=setInterval(function(){controller.friendTrend.play(1);},3000);};VC.net.dataLoader(config.url.getTrend,{r:Math.random()},function(ret){if(ret.ret==0&&ret.data){onSuc(ret.data);}else{onErr();}},onErr,{valueStatId:config.valueStatId.getTrend});}};var timeout_scroller,commenetsData;controller.friendTrend=friendTrend;controller.onInit(friendTrend.init);}();!function(){var settings={value:null,getPrivacy:function(onSuccess,onError){V.util.postForm({url:config.url.getPrivacy,param:{type:1},valueStatId:config.valueStatId.getPrivacy,onSuccess:function(ret){if(ret.ret==0){onSuccess(ret);}else{onError(ret);}},onError:onError});},setPrivacy:function(value){function succ(){settings.enable();$((value==0)?'setting_show':'setting_hide').checked=true;settings.value=value;QZONE.FP.showMsgbox("设置成功",3,2000);window.tcssStat.report("VC.FRIEND_TREND.SET_"+(value==0?'VISIBLE':'INVISIBLE'));}
function err(){settings.enable();QZONE.FP.showMsgbox("系统繁忙，请稍后再试",3,2000);}
settings.disable();V.util.postForm({url:config.url.setPrivacy,valueStatId:config.valueStatId.setPrivacy,param:{value:value,type:2},onSuccess:function(ret){if(ret.ret==0){succ();}else{err();}},onError:err});},enable:function(){$e('#mod_everyone_watch .layer_dropdown_setting .radios input').each(function(x){x.disabled=false;});},disable:function(){$e('#mod_everyone_watch .layer_dropdown_setting .radios input').each(function(x){x.disabled=true;});},bind:function(){var loaded=false;var autoHide;$e('#mod_everyone_watch .dropdown_setting').onMouseEnter(function(){if(autoHide){clearTimeout(autoHide);autoHide=false;}}).bind('click',function(){$e('.layer_dropdown_setting').show();if(!loaded){loaded=true;settings.getPrivacy(function(ret){$((ret.msg=='0')?'setting_show':'setting_hide').checked=true;},function(){loaded=true;});}
QZFL.event.cancelBubble();}).show();$e('.layer_dropdown_setting').onMouseLeave(function(){autoHide=setTimeout("$e('.layer_dropdown_setting').hide()",200);}).bind('click',function(event){QZFL.event.cancelBubble();});$e(document.body).bind('click',function(){$e('.layer_dropdown_setting').hide();});$e('.layer_dropdown_setting .radios input').bind('click',function(){if(settings.value!=this.value){settings.setPrivacy(this.value);}});},init:function(){settings.bind();}};controller.privacySettings=settings;controller.onInit(settings.init);}();﻿!function(){V.util.clickStat=function(tag,domain,path){if(!tag)return;var url=['http://pinghot.qq.com/pingd?dm=',domain||location.hostname,'.hot&url=',path||'v2/video'||location.pathname,'&hottag=',tag,'&hotx=9999&hoty=9999&sds=',Math.random()].join('');try{parent.QZFL.pingSender(url);}catch(e){}};var stat={getAttribute:function(el,attrName){while(el&&el!=document.body){var tags=el.getAttribute(attrName);if(tags){return tags;}
el=el.parentNode;}},tags:[],report:function(tags){stat.tags.push(tags);},reportedImmediately:function(){var tags=stat.tags.splice(0,20);if(!tags||!tags.length)return;V.util.clickStat(tags.join(';'),'appstore.qzone.qq.com');},clickAction:function(e){var element=e.target||e.srcElement;var tag=stat.getAttribute(element,'_click_tag');tag&&stat.report(tag);},exposureStatUpdate:function(context){exposureStat.update(context);},init:function(){QZFL.event.on(document.body,'click',stat.clickAction);QZFL.event.on(window,"unload",function(){stat.reportedImmediately();});exposureStat.init();setInterval(stat.reportedImmediately,2000);}};window.tcssStat=stat;var exposureStat={init:function(){exposureStat.setExposureTag(document.body);V.widget.imgDemandLoader.bind();var exposed={}
V.widget.imgDemandLoader.attachHandler(function(el,percentage){var clickTag=stat.getAttribute(el,'_click_tag');if(!clickTag)return;clickTag=clickTag.replace(/\.click(?=\.|$)/i,'.EXPOSURE');if(exposed[clickTag])return;if(percentage>50){exposed[clickTag]=true;stat.report(clickTag);}});},update:function(context){exposureStat.setExposureTag(context);V.widget.imgDemandLoader.update(true);},setExposureTag:function(context){$e('a[_click_tag]',context||document.body).each(function(e){var imgs=e.getElementsByTagName("img");var img;if(!imgs||!imgs.length){img=new Image();img.src='http://qzonestyle.gtimg.cn/ac/b.gif';img.style.cssText='border:0; width:1px; height:1px; position:absolute';e.appendChild(img);}else{img=imgs[0];}
if(img.getAttribute('_demand')!='1'){img.setAttribute('_demand',1);}
var hasExposure=img.getAttribute('_has_exposure');if(hasExposure==null||hasExposure==''){img.setAttribute('_has_exposure',0);}});}};}();/*  |xGv00|b0679068a46d0c61fad3d997ef591c04 */